Running command: python mmt+/train.py -m retnet -d sod -o exp/sod/retnet -g 0
Using arguments:
{'abs_pos_emb': True,
 'aug': True,
 'batch_size': 8,
 'comment_path': 'md5_to_attribute.pickle',
 'dataset': 'sod',
 'dim': 512,
 'dropout': 0.2,
 'early_stopping': True,
 'early_stopping_tolerance': 20,
 'gpu': 0,
 'grad_norm_clip': 1.0,
 'heads': 8,
 'in_dir': PosixPath('data/sod/processed/notes'),
 'jobs': 4,
 'layers': 6,
 'learning_rate': 0.0005,
 'lr_decay_multiplier': 0.1,
 'lr_decay_steps': 100000,
 'lr_warmup_steps': 5000,
 'max_beat': 256,
 'max_seq_len': 1024,
 'model': 'retnet',
 'out_dir': PosixPath('/hpctmp/e0787977/mmt/exp/sod/retnet'),
 'quiet': False,
 'rel_pos_emb': False,
 'steps': 200000,
 'tokenizer_path': 'tokenizer.model',
 'train_names': PosixPath('data/sod/processed/train-names.txt'),
 'update_policy': 'task',
 'use_csv': False,
 'valid_names': PosixPath('data/sod/processed/valid-names.txt'),
 'valid_steps': 1000}
Saved arguments to /hpctmp/e0787977/mmt/exp/sod/retnet/train-args.json
Using device: cuda:0
Creating the data loader...
Creating model...
Number of parameters: 28115456
Number of trainable parameters: 28115456
Training...
Validating...
Validation loss: 8.4035
Individual losses: type=0.0005, beat: 0.1188, position: 0.1153, pitch: 0.4373, duration: 0.2274, instrument: 0.2663timesignaturenumerator: 0.1176timesignaturedenominator: 0.0192tempo: 0.0130velocity: 0.0852
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_1000.pt
Training...
Validating...
Validation loss: 8.5049
Individual losses: type=0.0005, beat: 0.0823, position: 0.1056, pitch: 0.4376, duration: 0.2117, instrument: 0.2614timesignaturenumerator: 0.1261timesignaturedenominator: 0.0079tempo: 0.1174velocity: 0.0669
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_2000.pt
Training...
Validating...
Validation loss: 6.5671
Individual losses: type=0.0005, beat: 0.0724, position: 0.0964, pitch: 0.4195, duration: 0.1999, instrument: 0.2376timesignaturenumerator: 0.0106timesignaturedenominator: 0.0094tempo: 0.0035velocity: 0.0446
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_3000.pt
Training...
Validating...
Validation loss: 6.7178
Individual losses: type=0.0004, beat: 0.0715, position: 0.0951, pitch: 0.4220, duration: 0.2049, instrument: 0.2419timesignaturenumerator: 0.0220timesignaturedenominator: 0.0060tempo: 0.0064velocity: 0.0493
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_4000.pt
Training...
Validating...
Validation loss: 6.4550
Individual losses: type=0.0004, beat: 0.0702, position: 0.0923, pitch: 0.4203, duration: 0.1979, instrument: 0.2340timesignaturenumerator: 0.0045timesignaturedenominator: 0.0041tempo: 0.0044velocity: 0.0477
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_5000.pt
Training...
Validating...
Validation loss: 6.6895
Individual losses: type=0.0004, beat: 0.0705, position: 0.0954, pitch: 0.4319, duration: 0.2012, instrument: 0.2438timesignaturenumerator: 0.0108timesignaturedenominator: 0.0072tempo: 0.0035velocity: 0.0501
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_6000.pt
Training...
Validating...
Validation loss: 6.4377
Individual losses: type=0.0005, beat: 0.0685, position: 0.0916, pitch: 0.4182, duration: 0.2034, instrument: 0.2310timesignaturenumerator: 0.0047timesignaturedenominator: 0.0019tempo: 0.0038velocity: 0.0493
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_7000.pt
Training...
Validating...
Validation loss: 6.3848
Individual losses: type=0.0004, beat: 0.0674, position: 0.0930, pitch: 0.4124, duration: 0.1991, instrument: 0.2293timesignaturenumerator: 0.0035timesignaturedenominator: 0.0032tempo: 0.0085velocity: 0.0474
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_8000.pt
Training...
Validating...
Validation loss: 6.2997
Individual losses: type=0.0005, beat: 0.0654, position: 0.0912, pitch: 0.4188, duration: 0.1950, instrument: 0.2263timesignaturenumerator: 0.0050timesignaturedenominator: 0.0014tempo: 0.0021velocity: 0.0441
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_9000.pt
Training...
Validating...
Validation loss: 6.3828
Individual losses: type=0.0005, beat: 0.0659, position: 0.0915, pitch: 0.4246, duration: 0.1961, instrument: 0.2204timesignaturenumerator: 0.0056timesignaturedenominator: 0.0147tempo: 0.0023velocity: 0.0423
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_10000.pt
Training...
Validating...
Validation loss: 6.1257
Individual losses: type=0.0005, beat: 0.0655, position: 0.0875, pitch: 0.4125, duration: 0.1919, instrument: 0.2145timesignaturenumerator: 0.0036timesignaturedenominator: 0.0017tempo: 0.0019velocity: 0.0414
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_11000.pt
Training...
Validating...
Validation loss: 6.0893
Individual losses: type=0.0006, beat: 0.0629, position: 0.0858, pitch: 0.4147, duration: 0.1925, instrument: 0.2100timesignaturenumerator: 0.0031timesignaturedenominator: 0.0017tempo: 0.0021velocity: 0.0414
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_12000.pt
Training...
Validating...
Validation loss: 5.9768
Individual losses: type=0.0005, beat: 0.0614, position: 0.0866, pitch: 0.4045, duration: 0.1890, instrument: 0.2080timesignaturenumerator: 0.0030timesignaturedenominator: 0.0014tempo: 0.0019velocity: 0.0397
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_13000.pt
Training...
Validating...
Validation loss: 6.0348
Individual losses: type=0.0006, beat: 0.0607, position: 0.0856, pitch: 0.4144, duration: 0.1903, instrument: 0.2074timesignaturenumerator: 0.0036timesignaturedenominator: 0.0019tempo: 0.0024velocity: 0.0390
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_14000.pt
Training...
Validating...
Validation loss: 5.8878
Individual losses: type=0.0005, beat: 0.0586, position: 0.0842, pitch: 0.4045, duration: 0.1888, instrument: 0.1997timesignaturenumerator: 0.0031timesignaturedenominator: 0.0016tempo: 0.0020velocity: 0.0384
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_15000.pt
Training...
Validating...
Validation loss: 5.9199
Individual losses: type=0.0006, beat: 0.0597, position: 0.0850, pitch: 0.4056, duration: 0.1888, instrument: 0.1989timesignaturenumerator: 0.0036timesignaturedenominator: 0.0016tempo: 0.0032velocity: 0.0397
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_16000.pt
Training...
Validating...
Validation loss: 5.9147
Individual losses: type=0.0006, beat: 0.0604, position: 0.0843, pitch: 0.4041, duration: 0.1874, instrument: 0.2006timesignaturenumerator: 0.0056timesignaturedenominator: 0.0017tempo: 0.0026velocity: 0.0385
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_17000.pt
Training...
Validating...
Validation loss: 5.9403
Individual losses: type=0.0006, beat: 0.0588, position: 0.0849, pitch: 0.4030, duration: 0.1896, instrument: 0.2034timesignaturenumerator: 0.0055timesignaturedenominator: 0.0016tempo: 0.0036velocity: 0.0391
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_18000.pt
Training...
Validating...
Validation loss: 5.8744
Individual losses: type=0.0006, beat: 0.0568, position: 0.0858, pitch: 0.4035, duration: 0.1891, instrument: 0.1987timesignaturenumerator: 0.0034timesignaturedenominator: 0.0014tempo: 0.0019velocity: 0.0378
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_19000.pt
Training...
Validating...
Validation loss: 5.7902
Individual losses: type=0.0006, beat: 0.0554, position: 0.0843, pitch: 0.3981, duration: 0.1854, instrument: 0.1954timesignaturenumerator: 0.0046timesignaturedenominator: 0.0013tempo: 0.0023velocity: 0.0376
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_20000.pt
Training...
Validating...
Validation loss: 5.8623
Individual losses: type=0.0006, beat: 0.0563, position: 0.0835, pitch: 0.4010, duration: 0.1891, instrument: 0.1997timesignaturenumerator: 0.0048timesignaturedenominator: 0.0019tempo: 0.0021velocity: 0.0380
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/retnet/checkpoints/model_21000.pt
Training...
