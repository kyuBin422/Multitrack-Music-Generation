Running command: python mmt+/train.py -m mamba -d sod -o exp/sod/mamba -g 0
Using arguments:
{'abs_pos_emb': True,
 'aug': True,
 'batch_size': 8,
 'comment_path': 'md5_to_attribute.pickle',
 'dataset': 'sod',
 'dim': 512,
 'dropout': 0.2,
 'early_stopping': True,
 'early_stopping_tolerance': 20,
 'gpu': 0,
 'grad_norm_clip': 1.0,
 'heads': 8,
 'in_dir': PosixPath('data/sod/processed/notes'),
 'jobs': 4,
 'layers': 6,
 'learning_rate': 0.0005,
 'lr_decay_multiplier': 0.1,
 'lr_decay_steps': 100000,
 'lr_warmup_steps': 5000,
 'max_beat': 256,
 'max_seq_len': 1024,
 'model': 'mamba',
 'out_dir': PosixPath('/hpctmp/e0787977/mmt/exp/sod/mamba'),
 'quiet': False,
 'rel_pos_emb': False,
 'steps': 200000,
 'tokenizer_path': 'tokenizer.model',
 'train_names': PosixPath('data/sod/processed/train-names.txt'),
 'update_policy': 'task',
 'use_csv': False,
 'valid_names': PosixPath('data/sod/processed/valid-names.txt'),
 'valid_steps': 1000}
Saved arguments to /hpctmp/e0787977/mmt/exp/sod/mamba/train-args.json
Using device: cuda:0
Creating the data loader...
Creating model...
Number of parameters: 11546938
Number of trainable parameters: 11546938
Training...
Validating...
Validation loss: 7.7669
Individual losses: type=0.0011, beat: 0.1351, position: 0.1131, pitch: 0.4455, duration: 0.2160, instrument: 0.2742timesignaturenumerator: 0.0302timesignaturedenominator: 0.0167tempo: 0.0076velocity: 0.0550
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_1000.pt
Training...
Validating...
Validation loss: 6.6500
Individual losses: type=0.0009, beat: 0.0802, position: 0.0998, pitch: 0.4203, duration: 0.1988, instrument: 0.2361timesignaturenumerator: 0.0128timesignaturedenominator: 0.0034tempo: 0.0095velocity: 0.0463
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_2000.pt
Training...
Validating...
Validation loss: 6.2012
Individual losses: type=0.0009, beat: 0.0703, position: 0.0919, pitch: 0.4074, duration: 0.1940, instrument: 0.2194timesignaturenumerator: 0.0055timesignaturedenominator: 0.0016tempo: 0.0019velocity: 0.0406
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_3000.pt
Training...
Validating...
Validation loss: 5.9942
Individual losses: type=0.0008, beat: 0.0648, position: 0.0868, pitch: 0.3998, duration: 0.1891, instrument: 0.2105timesignaturenumerator: 0.0059timesignaturedenominator: 0.0014tempo: 0.0018velocity: 0.0381
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_4000.pt
Training...
Validating...
Validation loss: 5.6935
Individual losses: type=0.0008, beat: 0.0526, position: 0.0831, pitch: 0.3882, duration: 0.1847, instrument: 0.1927timesignaturenumerator: 0.0040timesignaturedenominator: 0.0014tempo: 0.0020velocity: 0.0394
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_5000.pt
Training...
Validating...
Validation loss: 5.6696
Individual losses: type=0.0008, beat: 0.0534, position: 0.0816, pitch: 0.3851, duration: 0.1831, instrument: 0.1915timesignaturenumerator: 0.0057timesignaturedenominator: 0.0015tempo: 0.0023velocity: 0.0398
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_6000.pt
Training...
Validating...
Validation loss: 5.4961
Individual losses: type=0.0009, beat: 0.0474, position: 0.0761, pitch: 0.3791, duration: 0.1815, instrument: 0.1850timesignaturenumerator: 0.0040timesignaturedenominator: 0.0016tempo: 0.0020velocity: 0.0384
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_7000.pt
Training...
Validating...
Validation loss: 5.3563
Individual losses: type=0.0009, beat: 0.0475, position: 0.0742, pitch: 0.3764, duration: 0.1785, instrument: 0.1738timesignaturenumerator: 0.0033timesignaturedenominator: 0.0014tempo: 0.0019velocity: 0.0348
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_8000.pt
Training...
Validating...
Validation loss: 5.1554
Individual losses: type=0.0008, beat: 0.0433, position: 0.0690, pitch: 0.3703, duration: 0.1731, instrument: 0.1627timesignaturenumerator: 0.0032timesignaturedenominator: 0.0014tempo: 0.0020velocity: 0.0334
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_9000.pt
Training...
Validating...
Validation loss: 5.0577
Individual losses: type=0.0009, beat: 0.0419, position: 0.0671, pitch: 0.3643, duration: 0.1721, instrument: 0.1565timesignaturenumerator: 0.0028timesignaturedenominator: 0.0014tempo: 0.0022velocity: 0.0338
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_10000.pt
Training...
Validating...
Validation loss: 4.9776
Individual losses: type=0.0009, beat: 0.0403, position: 0.0640, pitch: 0.3614, duration: 0.1687, instrument: 0.1565timesignaturenumerator: 0.0027timesignaturedenominator: 0.0014tempo: 0.0018velocity: 0.0320
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_11000.pt
Training...
Validating...
Validation loss: 4.8848
Individual losses: type=0.0009, beat: 0.0396, position: 0.0622, pitch: 0.3567, duration: 0.1662, instrument: 0.1490timesignaturenumerator: 0.0039timesignaturedenominator: 0.0015tempo: 0.0018velocity: 0.0322
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_12000.pt
Training...
Validating...
Validation loss: 4.8367
Individual losses: type=0.0008, beat: 0.0389, position: 0.0613, pitch: 0.3561, duration: 0.1654, instrument: 0.1465timesignaturenumerator: 0.0034timesignaturedenominator: 0.0013tempo: 0.0017velocity: 0.0307
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_13000.pt
Training...
Validating...
Validation loss: 5.3966
Individual losses: type=0.0008, beat: 0.0515, position: 0.0729, pitch: 0.3827, duration: 0.1747, instrument: 0.1680timesignaturenumerator: 0.0044timesignaturedenominator: 0.0017tempo: 0.0021velocity: 0.0405
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_14000.pt
Training...
Validating...
Validation loss: 4.6287
Individual losses: type=0.0008, beat: 0.0365, position: 0.0576, pitch: 0.3463, duration: 0.1593, instrument: 0.1348timesignaturenumerator: 0.0024timesignaturedenominator: 0.0014tempo: 0.0017velocity: 0.0307
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_15000.pt
Training...
Validating...
Validation loss: 4.5445
Individual losses: type=0.0009, beat: 0.0364, position: 0.0562, pitch: 0.3399, duration: 0.1570, instrument: 0.1321timesignaturenumerator: 0.0024timesignaturedenominator: 0.0013tempo: 0.0017velocity: 0.0295
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_16000.pt
Training...
Validating...
Validation loss: 4.4605
Individual losses: type=0.0009, beat: 0.0358, position: 0.0539, pitch: 0.3365, duration: 0.1547, instrument: 0.1275timesignaturenumerator: 0.0026timesignaturedenominator: 0.0013tempo: 0.0017velocity: 0.0287
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_17000.pt
Training...
Validating...
Validation loss: 4.4093
Individual losses: type=0.0009, beat: 0.0356, position: 0.0531, pitch: 0.3334, duration: 0.1532, instrument: 0.1245timesignaturenumerator: 0.0025timesignaturedenominator: 0.0014tempo: 0.0017velocity: 0.0284
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_18000.pt
Training...
Validating...
Validation loss: 4.3252
Individual losses: type=0.0008, beat: 0.0321, position: 0.0512, pitch: 0.3288, duration: 0.1533, instrument: 0.1211timesignaturenumerator: 0.0024timesignaturedenominator: 0.0012tempo: 0.0017velocity: 0.0283
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_19000.pt
Training...
Validating...
Validation loss: 4.2611
Individual losses: type=0.0010, beat: 0.0325, position: 0.0501, pitch: 0.3252, duration: 0.1508, instrument: 0.1176timesignaturenumerator: 0.0026timesignaturedenominator: 0.0014tempo: 0.0018velocity: 0.0272
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_20000.pt
Training...
Validating...
Validation loss: 4.1037
Individual losses: type=0.0008, beat: 0.0299, position: 0.0473, pitch: 0.3157, duration: 0.1464, instrument: 0.1119timesignaturenumerator: 0.0023timesignaturedenominator: 0.0013tempo: 0.0017velocity: 0.0266
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_21000.pt
Training...
Validating...
Validation loss: 4.1403
Individual losses: type=0.0009, beat: 0.0300, position: 0.0474, pitch: 0.3166, duration: 0.1460, instrument: 0.1162timesignaturenumerator: 0.0027timesignaturedenominator: 0.0014tempo: 0.0017velocity: 0.0272
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_22000.pt
Training...
Validating...
Validation loss: 4.0165
Individual losses: type=0.0011, beat: 0.0295, position: 0.0451, pitch: 0.3081, duration: 0.1458, instrument: 0.1081timesignaturenumerator: 0.0025timesignaturedenominator: 0.0015tempo: 0.0017velocity: 0.0259
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_23000.pt
Training...
Validating...
Validation loss: 3.9146
Individual losses: type=0.0008, beat: 0.0285, position: 0.0443, pitch: 0.3026, duration: 0.1408, instrument: 0.1050timesignaturenumerator: 0.0024timesignaturedenominator: 0.0013tempo: 0.0016velocity: 0.0251
Saved the model to: /hpctmp/e0787977/mmt/exp/sod/mamba/checkpoints/model_24000.pt
Training...
