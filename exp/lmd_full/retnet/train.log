Running command: python mmt+/train.py -m retnet -d lmd_full -o exp/lmd_full/retnet -g 0
Using arguments:
{'abs_pos_emb': True,
 'aug': True,
 'batch_size': 8,
 'comment_path': 'md5_to_attribute.pickle',
 'dataset': 'lmd_full',
 'dim': 512,
 'dropout': 0.2,
 'early_stopping': True,
 'early_stopping_tolerance': 20,
 'gpu': 0,
 'grad_norm_clip': 1.0,
 'heads': 8,
 'in_dir': PosixPath('data/lmd_full/processed/notes'),
 'jobs': 4,
 'layers': 6,
 'learning_rate': 0.0005,
 'lr_decay_multiplier': 0.1,
 'lr_decay_steps': 100000,
 'lr_warmup_steps': 5000,
 'max_beat': 256,
 'max_seq_len': 1024,
 'model': 'retnet',
 'out_dir': PosixPath('/hpctmp/e0787977/mmt/exp/lmd_full/retnet'),
 'quiet': False,
 'rel_pos_emb': False,
 'steps': 200000,
 'tokenizer_path': 'tokenizer.model',
 'train_names': PosixPath('data/lmd_full/processed/train-names.txt'),
 'update_policy': 'task',
 'use_csv': False,
 'valid_names': PosixPath('data/lmd_full/processed/valid-names.txt'),
 'valid_steps': 1000}
Saved arguments to /hpctmp/e0787977/mmt/exp/lmd_full/retnet/train-args.json
Using device: cuda:0
Creating the data loader...
Creating model...
Number of parameters: 28115456
Number of trainable parameters: 28115456
Training...
Validating...
Validation loss: 11.1827
Individual losses: type=0.0005, beat: 0.1309, position: 0.1757, pitch: 0.5338, duration: 0.3347, instrument: 0.3746timesignaturenumerator: 0.1818timesignaturedenominator: 0.0144tempo: 0.0068velocity: 0.1107
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_1000.pt
Training...
Validating...
Validation loss: 9.4351
Individual losses: type=0.0003, beat: 0.0773, position: 0.1729, pitch: 0.5146, duration: 0.3290, instrument: 0.3523timesignaturenumerator: 0.0095timesignaturedenominator: 0.0034tempo: 0.0038velocity: 0.1094
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_2000.pt
Training...
Validating...
Validation loss: 15.3099
Individual losses: type=0.0006, beat: 0.6675, position: 0.2401, pitch: 0.5775, duration: 0.4143, instrument: 0.4405timesignaturenumerator: 0.0451timesignaturedenominator: 0.0087tempo: 0.0246velocity: 0.1327
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_3000.pt
Training...
Validating...
Validation loss: 15.1569
Individual losses: type=0.0004, beat: 0.6172, position: 0.2371, pitch: 0.5931, duration: 0.3933, instrument: 0.4340timesignaturenumerator: 0.0522timesignaturedenominator: 0.0255tempo: 0.0363velocity: 0.1370
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_4000.pt
Training...
Validating...
Validation loss: 13.5789
Individual losses: type=0.0004, beat: 0.5111, position: 0.2134, pitch: 0.5760, duration: 0.3804, instrument: 0.4160timesignaturenumerator: 0.0316timesignaturedenominator: 0.0062tempo: 0.0079velocity: 0.1202
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_5000.pt
Training...
Validating...
Validation loss: 12.3590
Individual losses: type=0.0003, beat: 0.3595, position: 0.2043, pitch: 0.5650, duration: 0.3757, instrument: 0.3973timesignaturenumerator: 0.0271timesignaturedenominator: 0.0098tempo: 0.0037velocity: 0.1172
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_6000.pt
Training...
Validating...
Validation loss: 12.0254
Individual losses: type=0.0003, beat: 0.3227, position: 0.1961, pitch: 0.5750, duration: 0.3611, instrument: 0.3906timesignaturenumerator: 0.0281timesignaturedenominator: 0.0095tempo: 0.0026velocity: 0.1182
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_7000.pt
Training...
Validating...
Validation loss: 10.8655
Individual losses: type=0.0003, beat: 0.2004, position: 0.1860, pitch: 0.5532, duration: 0.3548, instrument: 0.3723timesignaturenumerator: 0.0195timesignaturedenominator: 0.0053tempo: 0.0018velocity: 0.1172
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_8000.pt
Training...
Validating...
Validation loss: 10.2039
Individual losses: type=0.0003, beat: 0.1419, position: 0.1786, pitch: 0.5396, duration: 0.3416, instrument: 0.3618timesignaturenumerator: 0.0208timesignaturedenominator: 0.0051tempo: 0.0020velocity: 0.1088
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_9000.pt
Training...
Validating...
Validation loss: 12.9154
Individual losses: type=0.0039, beat: 0.1667, position: 0.1906, pitch: 0.5351, duration: 0.3489, instrument: 0.3932timesignaturenumerator: 0.0697timesignaturedenominator: 0.0136tempo: 0.0205velocity: 0.4103
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_10000.pt
Training...
Validating...
Validation loss: 9.5304
Individual losses: type=0.0003, beat: 0.0948, position: 0.1696, pitch: 0.5170, duration: 0.3309, instrument: 0.3503timesignaturenumerator: 0.0153timesignaturedenominator: 0.0034tempo: 0.0017velocity: 0.1052
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_11000.pt
Training...
Validating...
Validation loss: 9.5034
Individual losses: type=0.0003, beat: 0.0911, position: 0.1691, pitch: 0.5171, duration: 0.3286, instrument: 0.3456timesignaturenumerator: 0.0185timesignaturedenominator: 0.0055tempo: 0.0016velocity: 0.1065
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_12000.pt
Training...
Validating...
Validation loss: 9.4910
Individual losses: type=0.0003, beat: 0.0854, position: 0.1682, pitch: 0.5143, duration: 0.3279, instrument: 0.3462timesignaturenumerator: 0.0190timesignaturedenominator: 0.0112tempo: 0.0029velocity: 0.1065
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_13000.pt
Training...
Validating...
Validation loss: 9.2163
Individual losses: type=0.0003, beat: 0.0830, position: 0.1653, pitch: 0.5054, duration: 0.3211, instrument: 0.3349timesignaturenumerator: 0.0139timesignaturedenominator: 0.0050tempo: 0.0014velocity: 0.1057
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_14000.pt
Training...
Validating...
Validation loss: 9.2271
Individual losses: type=0.0003, beat: 0.0803, position: 0.1646, pitch: 0.5044, duration: 0.3223, instrument: 0.3407timesignaturenumerator: 0.0148timesignaturedenominator: 0.0069tempo: 0.0015velocity: 0.1022
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_15000.pt
Training...
Validating...
Validation loss: 9.3528
Individual losses: type=0.0003, beat: 0.0788, position: 0.1673, pitch: 0.5070, duration: 0.3230, instrument: 0.3421timesignaturenumerator: 0.0203timesignaturedenominator: 0.0094tempo: 0.0066velocity: 0.1041
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_16000.pt
Training...
Validating...
Validation loss: 9.1273
Individual losses: type=0.0003, beat: 0.0764, position: 0.1634, pitch: 0.5021, duration: 0.3219, instrument: 0.3347timesignaturenumerator: 0.0146timesignaturedenominator: 0.0051tempo: 0.0014velocity: 0.1014
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_17000.pt
Training...
Validating...
Validation loss: 9.1015
Individual losses: type=0.0003, beat: 0.0755, position: 0.1628, pitch: 0.4990, duration: 0.3177, instrument: 0.3351timesignaturenumerator: 0.0145timesignaturedenominator: 0.0062tempo: 0.0036velocity: 0.1023
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_18000.pt
Training...
Validating...
Validation loss: 9.0608
Individual losses: type=0.0003, beat: 0.0739, position: 0.1606, pitch: 0.4958, duration: 0.3188, instrument: 0.3288timesignaturenumerator: 0.0182timesignaturedenominator: 0.0103tempo: 0.0015velocity: 0.1020
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_19000.pt
Training...
Validating...
Validation loss: 9.0326
Individual losses: type=0.0003, beat: 0.0750, position: 0.1607, pitch: 0.4978, duration: 0.3157, instrument: 0.3256timesignaturenumerator: 0.0164timesignaturedenominator: 0.0111tempo: 0.0016velocity: 0.1011
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_20000.pt
Training...
Validating...
Validation loss: 8.8629
Individual losses: type=0.0003, beat: 0.0717, position: 0.1611, pitch: 0.4897, duration: 0.3136, instrument: 0.3210timesignaturenumerator: 0.0122timesignaturedenominator: 0.0050tempo: 0.0017velocity: 0.1009
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_21000.pt
Training...
Validating...
Validation loss: 8.8634
Individual losses: type=0.0003, beat: 0.0715, position: 0.1579, pitch: 0.4882, duration: 0.3134, instrument: 0.3250timesignaturenumerator: 0.0129timesignaturedenominator: 0.0054tempo: 0.0022velocity: 0.1005
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_22000.pt
Training...
Validating...
Validation loss: 8.8152
Individual losses: type=0.0002, beat: 0.0686, position: 0.1566, pitch: 0.4854, duration: 0.3148, instrument: 0.3202timesignaturenumerator: 0.0140timesignaturedenominator: 0.0052tempo: 0.0033velocity: 0.1009
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_23000.pt
Training...
Validating...
Validation loss: 9.0511
Individual losses: type=0.0002, beat: 0.0714, position: 0.1607, pitch: 0.4991, duration: 0.3178, instrument: 0.3293timesignaturenumerator: 0.0189timesignaturedenominator: 0.0089tempo: 0.0019velocity: 0.1001
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_24000.pt
Training...
Validating...
Validation loss: 8.8650
Individual losses: type=0.0006, beat: 0.0690, position: 0.1571, pitch: 0.4875, duration: 0.3144, instrument: 0.3202timesignaturenumerator: 0.0176timesignaturedenominator: 0.0101tempo: 0.0015velocity: 0.0993
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_25000.pt
Training...
Validating...
Validation loss: 8.8490
Individual losses: type=0.0002, beat: 0.0692, position: 0.1583, pitch: 0.4890, duration: 0.3145, instrument: 0.3206timesignaturenumerator: 0.0140timesignaturedenominator: 0.0077tempo: 0.0013velocity: 0.1001
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_26000.pt
Training...
Validating...
Validation loss: 8.7921
Individual losses: type=0.0003, beat: 0.0682, position: 0.1555, pitch: 0.4864, duration: 0.3129, instrument: 0.3154timesignaturenumerator: 0.0167timesignaturedenominator: 0.0071tempo: 0.0014velocity: 0.1013
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_27000.pt
Training...
Validating...
Validation loss: 8.9428
Individual losses: type=0.0002, beat: 0.0695, position: 0.1560, pitch: 0.4922, duration: 0.3149, instrument: 0.3234timesignaturenumerator: 0.0237timesignaturedenominator: 0.0100tempo: 0.0013velocity: 0.0992
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_28000.pt
Training...
Validating...
Validation loss: 8.6710
Individual losses: type=0.0002, beat: 0.0678, position: 0.1529, pitch: 0.4828, duration: 0.3126, instrument: 0.3132timesignaturenumerator: 0.0123timesignaturedenominator: 0.0042tempo: 0.0013velocity: 0.0977
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_29000.pt
Training...
Validating...
Validation loss: 8.7115
Individual losses: type=0.0002, beat: 0.0678, position: 0.1542, pitch: 0.4807, duration: 0.3149, instrument: 0.3144timesignaturenumerator: 0.0140timesignaturedenominator: 0.0060tempo: 0.0013velocity: 0.0983
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_30000.pt
Training...
Validating...
Validation loss: 8.6609
Individual losses: type=0.0002, beat: 0.0692, position: 0.1547, pitch: 0.4801, duration: 0.3094, instrument: 0.3128timesignaturenumerator: 0.0119timesignaturedenominator: 0.0048tempo: 0.0013velocity: 0.0989
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_31000.pt
Training...
Validating...
Validation loss: 8.7370
Individual losses: type=0.0002, beat: 0.0663, position: 0.1542, pitch: 0.4841, duration: 0.3109, instrument: 0.3155timesignaturenumerator: 0.0192timesignaturedenominator: 0.0071tempo: 0.0013velocity: 0.0974
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_32000.pt
Training...
Validating...
Validation loss: 8.6742
Individual losses: type=0.0002, beat: 0.0662, position: 0.1541, pitch: 0.4786, duration: 0.3124, instrument: 0.3153timesignaturenumerator: 0.0144timesignaturedenominator: 0.0061tempo: 0.0013velocity: 0.0971
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_33000.pt
Training...
Validating...
Validation loss: 8.6676
Individual losses: type=0.0002, beat: 0.0668, position: 0.1554, pitch: 0.4814, duration: 0.3109, instrument: 0.3124timesignaturenumerator: 0.0131timesignaturedenominator: 0.0064tempo: 0.0012velocity: 0.0967
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_34000.pt
Training...
Validating...
Validation loss: 8.6142
Individual losses: type=0.0003, beat: 0.0654, position: 0.1513, pitch: 0.4793, duration: 0.3087, instrument: 0.3087timesignaturenumerator: 0.0159timesignaturedenominator: 0.0083tempo: 0.0013velocity: 0.0965
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_35000.pt
Training...
Validating...
Validation loss: 8.5143
Individual losses: type=0.0002, beat: 0.0637, position: 0.1503, pitch: 0.4769, duration: 0.3089, instrument: 0.3061timesignaturenumerator: 0.0094timesignaturedenominator: 0.0060tempo: 0.0013velocity: 0.0963
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_36000.pt
Training...
Validating...
Validation loss: 8.5090
Individual losses: type=0.0002, beat: 0.0635, position: 0.1501, pitch: 0.4762, duration: 0.3077, instrument: 0.3071timesignaturenumerator: 0.0099timesignaturedenominator: 0.0046tempo: 0.0012velocity: 0.0976
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_37000.pt
Training...
Validating...
Validation loss: 8.5751
Individual losses: type=0.0002, beat: 0.0634, position: 0.1512, pitch: 0.4787, duration: 0.3094, instrument: 0.3110timesignaturenumerator: 0.0127timesignaturedenominator: 0.0038tempo: 0.0021velocity: 0.0966
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_38000.pt
Training...
Validating...
Validation loss: 9.2028
Individual losses: type=0.0002, beat: 0.0634, position: 0.1511, pitch: 0.4812, duration: 0.3145, instrument: 0.3119timesignaturenumerator: 0.0109timesignaturedenominator: 0.0052tempo: 0.0992velocity: 0.0961
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_39000.pt
Training...
Validating...
Validation loss: 8.4906
Individual losses: type=0.0002, beat: 0.0626, position: 0.1515, pitch: 0.4773, duration: 0.3093, instrument: 0.3043timesignaturenumerator: 0.0088timesignaturedenominator: 0.0037tempo: 0.0013velocity: 0.0960
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_40000.pt
Training...
Validating...
Validation loss: 8.4564
Individual losses: type=0.0002, beat: 0.0631, position: 0.1486, pitch: 0.4772, duration: 0.3072, instrument: 0.3038timesignaturenumerator: 0.0091timesignaturedenominator: 0.0031tempo: 0.0013velocity: 0.0957
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_41000.pt
Training...
Validating...
Validation loss: 8.3781
Individual losses: type=0.0002, beat: 0.0622, position: 0.1463, pitch: 0.4724, duration: 0.3045, instrument: 0.3001timesignaturenumerator: 0.0088timesignaturedenominator: 0.0036tempo: 0.0033velocity: 0.0949
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_42000.pt
Training...
Validating...
Validation loss: 8.3690
Individual losses: type=0.0002, beat: 0.0619, position: 0.1466, pitch: 0.4729, duration: 0.3064, instrument: 0.2990timesignaturenumerator: 0.0075timesignaturedenominator: 0.0033tempo: 0.0019velocity: 0.0951
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_43000.pt
Training...
Validating...
Validation loss: 8.3762
Individual losses: type=0.0002, beat: 0.0619, position: 0.1464, pitch: 0.4740, duration: 0.3071, instrument: 0.2973timesignaturenumerator: 0.0084timesignaturedenominator: 0.0031tempo: 0.0014velocity: 0.0961
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_44000.pt
Training...
Validating...
Validation loss: 8.3541
Individual losses: type=0.0002, beat: 0.0637, position: 0.1469, pitch: 0.4693, duration: 0.3062, instrument: 0.2988timesignaturenumerator: 0.0081timesignaturedenominator: 0.0027tempo: 0.0016velocity: 0.0949
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_45000.pt
Training...
Validating...
Validation loss: 8.3558
Individual losses: type=0.0002, beat: 0.0618, position: 0.1460, pitch: 0.4710, duration: 0.3056, instrument: 0.2986timesignaturenumerator: 0.0080timesignaturedenominator: 0.0045tempo: 0.0013velocity: 0.0956
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_46000.pt
Training...
Validating...
Validation loss: 8.3318
Individual losses: type=0.0002, beat: 0.0613, position: 0.1464, pitch: 0.4706, duration: 0.3050, instrument: 0.2960timesignaturenumerator: 0.0088timesignaturedenominator: 0.0045tempo: 0.0012velocity: 0.0947
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_47000.pt
Training...
Validating...
Validation loss: 8.2874
Individual losses: type=0.0002, beat: 0.0608, position: 0.1451, pitch: 0.4691, duration: 0.3044, instrument: 0.2943timesignaturenumerator: 0.0072timesignaturedenominator: 0.0040tempo: 0.0011velocity: 0.0949
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_48000.pt
Training...
Validating...
Validation loss: 8.2501
Individual losses: type=0.0002, beat: 0.0604, position: 0.1448, pitch: 0.4677, duration: 0.3027, instrument: 0.2930timesignaturenumerator: 0.0072timesignaturedenominator: 0.0036tempo: 0.0012velocity: 0.0942
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_49000.pt
Training...
Validating...
Validation loss: 8.2620
Individual losses: type=0.0002, beat: 0.0604, position: 0.1451, pitch: 0.4662, duration: 0.3034, instrument: 0.2939timesignaturenumerator: 0.0080timesignaturedenominator: 0.0039tempo: 0.0012velocity: 0.0948
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_50000.pt
Training...
Validating...
Validation loss: 8.2535
Individual losses: type=0.0002, beat: 0.0601, position: 0.1446, pitch: 0.4665, duration: 0.3036, instrument: 0.2930timesignaturenumerator: 0.0082timesignaturedenominator: 0.0037tempo: 0.0011velocity: 0.0945
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_51000.pt
Training...
Validating...
Validation loss: 8.2600
Individual losses: type=0.0002, beat: 0.0604, position: 0.1441, pitch: 0.4680, duration: 0.3038, instrument: 0.2930timesignaturenumerator: 0.0081timesignaturedenominator: 0.0036tempo: 0.0011velocity: 0.0943
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_52000.pt
Training...
Validating...
Validation loss: 8.2448
Individual losses: type=0.0002, beat: 0.0601, position: 0.1442, pitch: 0.4640, duration: 0.3040, instrument: 0.2925timesignaturenumerator: 0.0093timesignaturedenominator: 0.0038tempo: 0.0011velocity: 0.0949
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full/retnet/checkpoints/model_53000.pt
Training...
