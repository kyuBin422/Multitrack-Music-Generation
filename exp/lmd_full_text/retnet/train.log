Running command: python mmt+/train.py -m retnet -d lmd_full_text -o exp/lmd_full_text/retnet -g 1
Using arguments:
{'abs_pos_emb': True,
 'aug': True,
 'batch_size': 8,
 'comment_path': 'md5_to_attribute.pickle',
 'dataset': 'lmd_full_text',
 'dim': 512,
 'dropout': 0.2,
 'early_stopping': True,
 'early_stopping_tolerance': 20,
 'gpu': 1,
 'grad_norm_clip': 1.0,
 'heads': 8,
 'in_dir': PosixPath('data/lmd_full_text/processed/notes'),
 'jobs': 4,
 'layers': 6,
 'learning_rate': 0.0005,
 'lr_decay_multiplier': 0.1,
 'lr_decay_steps': 100000,
 'lr_warmup_steps': 5000,
 'max_beat': 256,
 'max_seq_len': 1024,
 'model': 'retnet',
 'out_dir': PosixPath('/hpctmp/e0787977/mmt/exp/lmd_full_text/retnet'),
 'quiet': False,
 'rel_pos_emb': False,
 'steps': 200000,
 'tokenizer_path': 'tokenizer.model',
 'train_names': PosixPath('data/lmd_full_text/processed/train-names.txt'),
 'update_policy': 'task',
 'use_csv': False,
 'valid_names': PosixPath('data/lmd_full_text/processed/valid-names.txt'),
 'valid_steps': 1000}
Saved arguments to /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/train-args.json
Using device: cuda:1
Creating the data loader...
Creating model...
Number of parameters: 60915456
Number of trainable parameters: 60915456
Training...
Validating...
Validation loss: 14.1864
Individual losses: type=0.0045, beat: 0.4954, position: 0.2141, pitch: 0.5920, duration: 0.3920, instrument: 0.4273timesignaturenumerator: 0.0565timesignaturedenominator: 0.0165tempo: 0.0324velocity: 0.1335
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_1000.pt
Training...
Validating...
Validation loss: 18.2311
Individual losses: type=0.0078, beat: 0.8087, position: 0.2617, pitch: 0.6079, duration: 0.4282, instrument: 0.4698timesignaturenumerator: 0.0902timesignaturedenominator: 0.0286tempo: 0.1508velocity: 0.1845
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_2000.pt
Training...
Validating...
Validation loss: 17.9622
Individual losses: type=0.0026, beat: 0.7997, position: 0.2575, pitch: 0.6195, duration: 0.4241, instrument: 0.4677timesignaturenumerator: 0.0871timesignaturedenominator: 0.0223tempo: 0.1443velocity: 0.1688
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_3000.pt
Training...
Validating...
Validation loss: 18.1069
Individual losses: type=0.0021, beat: 0.8062, position: 0.2688, pitch: 0.6175, duration: 0.4302, instrument: 0.4732timesignaturenumerator: 0.0779timesignaturedenominator: 0.0208tempo: 0.1536velocity: 0.1676
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_4000.pt
Training...
Validating...
Validation loss: 17.8206
Individual losses: type=0.0014, beat: 0.8084, position: 0.2641, pitch: 0.6097, duration: 0.4292, instrument: 0.4724timesignaturenumerator: 0.0627timesignaturedenominator: 0.0082tempo: 0.1448velocity: 0.1690
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_5000.pt
Training...
Validating...
Validation loss: 17.7120
Individual losses: type=0.0013, beat: 0.7982, position: 0.2571, pitch: 0.6089, duration: 0.4458, instrument: 0.4602timesignaturenumerator: 0.0555timesignaturedenominator: 0.0089tempo: 0.1462velocity: 0.1698
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_6000.pt
Training...
Validating...
Validation loss: 17.7117
Individual losses: type=0.0013, beat: 0.7856, position: 0.2651, pitch: 0.6075, duration: 0.4321, instrument: 0.4605timesignaturenumerator: 0.0611timesignaturedenominator: 0.0100tempo: 0.1437velocity: 0.1853
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_7000.pt
Training...
Validating...
Validation loss: 17.5868
Individual losses: type=0.0013, beat: 0.7816, position: 0.2586, pitch: 0.6161, duration: 0.4296, instrument: 0.4642timesignaturenumerator: 0.0580timesignaturedenominator: 0.0106tempo: 0.1398velocity: 0.1713
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_8000.pt
Training...
Validating...
Validation loss: 17.2477
Individual losses: type=0.0013, beat: 0.7880, position: 0.2544, pitch: 0.6042, duration: 0.4271, instrument: 0.4666timesignaturenumerator: 0.0534timesignaturedenominator: 0.0144tempo: 0.0917velocity: 0.1735
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_9000.pt
Training...
Validating...
Validation loss: 17.1945
Individual losses: type=0.0013, beat: 0.7732, position: 0.2578, pitch: 0.6247, duration: 0.4262, instrument: 0.4632timesignaturenumerator: 0.0568timesignaturedenominator: 0.0152tempo: 0.0835velocity: 0.1639
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_10000.pt
Training...
Validating...
Validation loss: 17.1046
Individual losses: type=0.0013, beat: 0.7638, position: 0.2516, pitch: 0.6186, duration: 0.4233, instrument: 0.4505timesignaturenumerator: 0.0629timesignaturedenominator: 0.0271tempo: 0.0792velocity: 0.1725
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_11000.pt
Training...
Validating...
Validation loss: 16.9693
Individual losses: type=0.0013, beat: 0.7640, position: 0.2649, pitch: 0.6006, duration: 0.4242, instrument: 0.4641timesignaturenumerator: 0.0530timesignaturedenominator: 0.0151tempo: 0.0742velocity: 0.1667
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_12000.pt
Training...
Validating...
Validation loss: 17.3690
Individual losses: type=0.0013, beat: 0.8007, position: 0.2506, pitch: 0.6035, duration: 0.4180, instrument: 0.4707timesignaturenumerator: 0.0623timesignaturedenominator: 0.0137tempo: 0.1128velocity: 0.1613
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_13000.pt
Training...
Validating...
Validation loss: 17.4616
Individual losses: type=0.0013, beat: 0.7971, position: 0.2526, pitch: 0.6128, duration: 0.4225, instrument: 0.4543timesignaturenumerator: 0.0610timesignaturedenominator: 0.0121tempo: 0.1388velocity: 0.1578
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_14000.pt
Training...
Validating...
Validation loss: 17.6669
Individual losses: type=0.0018, beat: 0.8015, position: 0.2530, pitch: 0.6091, duration: 0.4225, instrument: 0.4675timesignaturenumerator: 0.0735timesignaturedenominator: 0.0217tempo: 0.1294velocity: 0.1645
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_15000.pt
Training...
Validating...
Validation loss: 17.2006
Individual losses: type=0.0013, beat: 0.7879, position: 0.2497, pitch: 0.6128, duration: 0.4223, instrument: 0.4492timesignaturenumerator: 0.0640timesignaturedenominator: 0.0189tempo: 0.1056velocity: 0.1551
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_16000.pt
Training...
Validating...
Validation loss: 17.2085
Individual losses: type=0.0013, beat: 0.7940, position: 0.2511, pitch: 0.6147, duration: 0.4181, instrument: 0.4508timesignaturenumerator: 0.0690timesignaturedenominator: 0.0117tempo: 0.0974velocity: 0.1600
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_17000.pt
Training...
Validating...
Validation loss: 16.9163
Individual losses: type=0.0013, beat: 0.7850, position: 0.2465, pitch: 0.6110, duration: 0.4225, instrument: 0.4436timesignaturenumerator: 0.0657timesignaturedenominator: 0.0115tempo: 0.0693velocity: 0.1629
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_18000.pt
Training...
Validating...
Validation loss: 16.8589
Individual losses: type=0.0014, beat: 0.7808, position: 0.2510, pitch: 0.6079, duration: 0.4188, instrument: 0.4452timesignaturenumerator: 0.0580timesignaturedenominator: 0.0093tempo: 0.0857velocity: 0.1518
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_19000.pt
Training...
Validating...
Validation loss: 16.7057
Individual losses: type=0.0013, beat: 0.7602, position: 0.2485, pitch: 0.6115, duration: 0.4134, instrument: 0.4424timesignaturenumerator: 0.0526timesignaturedenominator: 0.0123tempo: 0.0895velocity: 0.1527
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_20000.pt
Training...
Validating...
Validation loss: 16.4261
Individual losses: type=0.0013, beat: 0.7483, position: 0.2422, pitch: 0.5998, duration: 0.4117, instrument: 0.4381timesignaturenumerator: 0.0509timesignaturedenominator: 0.0109tempo: 0.0854velocity: 0.1491
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_21000.pt
Training...
Validating...
Validation loss: 16.2811
Individual losses: type=0.0013, beat: 0.7460, position: 0.2404, pitch: 0.5970, duration: 0.4089, instrument: 0.4408timesignaturenumerator: 0.0486timesignaturedenominator: 0.0113tempo: 0.0691velocity: 0.1502
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/model_22000.pt
Stopped the training for no improvements in 20 rounds.
Minimum validation loss achieved: 14.186441657077744
Saved the optimizer state to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/optimizer_22000.pt
Saved the scheduler state to: /hpctmp/e0787977/mmt/exp/lmd_full_text/retnet/checkpoints/scheduler_22000.pt
