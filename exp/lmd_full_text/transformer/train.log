Running command: python mmt+/train.py -m transformer -d lmd_full_text -o exp/lmd_full_text/transformer -g 1
Using arguments:
{'abs_pos_emb': True,
 'aug': True,
 'batch_size': 8,
 'comment_path': 'md5_to_attribute.pickle',
 'dataset': 'lmd_full_text',
 'dim': 512,
 'dropout': 0.2,
 'early_stopping': True,
 'early_stopping_tolerance': 20,
 'gpu': 1,
 'grad_norm_clip': 1.0,
 'heads': 8,
 'in_dir': PosixPath('data/lmd_full_text/processed/notes'),
 'jobs': 4,
 'layers': 6,
 'learning_rate': 0.0005,
 'lr_decay_multiplier': 0.1,
 'lr_decay_steps': 100000,
 'lr_warmup_steps': 5000,
 'max_beat': 256,
 'max_seq_len': 1024,
 'model': 'transformer',
 'out_dir': PosixPath('/hpctmp/e0787977/mmt/exp/lmd_full_text/transformer'),
 'quiet': False,
 'rel_pos_emb': False,
 'steps': 200000,
 'tokenizer_path': 'tokenizer.model',
 'train_names': PosixPath('data/lmd_full_text/processed/train-names.txt'),
 'update_policy': 'task',
 'use_csv': False,
 'valid_names': PosixPath('data/lmd_full_text/processed/valid-names.txt'),
 'valid_steps': 1000}
Saved arguments to /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/train-args.json
Using device: cuda:1
Creating the data loader...
Creating model...
Number of parameters: 52813625
Number of trainable parameters: 52813625
Training...
Validating...
Validation loss: 15.9562
Individual losses: type=0.0018, beat: 0.6758, position: 0.2307, pitch: 0.6060, duration: 0.4051, instrument: 0.4393timesignaturenumerator: 0.0657timesignaturedenominator: 0.0224tempo: 0.0710velocity: 0.1415
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_1000.pt
Training...
Validating...
Validation loss: 11.6874
Individual losses: type=0.0014, beat: 0.2061, position: 0.1966, pitch: 0.5796, duration: 0.3676, instrument: 0.4117timesignaturenumerator: 0.0346timesignaturedenominator: 0.0084tempo: 0.0165velocity: 0.1256
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_2000.pt
Training...
Validating...
Validation loss: 10.2393
Individual losses: type=0.0013, beat: 0.0973, position: 0.1793, pitch: 0.5317, duration: 0.3472, instrument: 0.3961timesignaturenumerator: 0.0201timesignaturedenominator: 0.0054tempo: 0.0058velocity: 0.1223
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_3000.pt
Training...
Validating...
Validation loss: 16.0894
Individual losses: type=0.0025, beat: 0.6828, position: 0.2475, pitch: 0.5977, duration: 0.4132, instrument: 0.4623timesignaturenumerator: 0.0495timesignaturedenominator: 0.0110tempo: 0.0419velocity: 0.1730
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_4000.pt
Training...
Validating...
Validation loss: 16.1252
Individual losses: type=0.0024, beat: 0.6769, position: 0.2480, pitch: 0.6031, duration: 0.4208, instrument: 0.4546timesignaturenumerator: 0.0604timesignaturedenominator: 0.0144tempo: 0.0367velocity: 0.1702
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_5000.pt
Training...
Validating...
Validation loss: 15.5538
Individual losses: type=0.0024, beat: 0.6347, position: 0.2387, pitch: 0.5968, duration: 0.4154, instrument: 0.4475timesignaturenumerator: 0.0527timesignaturedenominator: 0.0126tempo: 0.0291velocity: 0.1624
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_6000.pt
Training...
Validating...
Validation loss: 14.9995
Individual losses: type=0.0019, beat: 0.5667, position: 0.2272, pitch: 0.5978, duration: 0.4109, instrument: 0.4547timesignaturenumerator: 0.0445timesignaturedenominator: 0.0125tempo: 0.0244velocity: 0.1592
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_7000.pt
Training...
Validating...
Validation loss: 14.3819
Individual losses: type=0.0018, beat: 0.4919, position: 0.2212, pitch: 0.5969, duration: 0.3998, instrument: 0.4422timesignaturenumerator: 0.0410timesignaturedenominator: 0.0136tempo: 0.0293velocity: 0.1593
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_8000.pt
Training...
Validating...
Validation loss: 15.4638
Individual losses: type=0.0027, beat: 0.5498, position: 0.2290, pitch: 0.5984, duration: 0.4050, instrument: 0.4497timesignaturenumerator: 0.0887timesignaturedenominator: 0.0271tempo: 0.0313velocity: 0.1957
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_9000.pt
Training...
Validating...
Validation loss: 14.1620
Individual losses: type=0.0021, beat: 0.4746, position: 0.2192, pitch: 0.5869, duration: 0.4014, instrument: 0.4410timesignaturenumerator: 0.0463timesignaturedenominator: 0.0123tempo: 0.0228velocity: 0.1538
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_10000.pt
Training...
Validating...
Validation loss: 13.5239
Individual losses: type=0.0018, beat: 0.4162, position: 0.2083, pitch: 0.5862, duration: 0.3927, instrument: 0.4283timesignaturenumerator: 0.0452timesignaturedenominator: 0.0105tempo: 0.0188velocity: 0.1460
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_11000.pt
Training...
Validating...
Validation loss: 13.2350
Individual losses: type=0.0023, beat: 0.3520, position: 0.2075, pitch: 0.5866, duration: 0.3862, instrument: 0.4429timesignaturenumerator: 0.0487timesignaturedenominator: 0.0104tempo: 0.0247velocity: 0.1446
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_12000.pt
Training...
Validating...
Validation loss: 13.0247
Individual losses: type=0.0034, beat: 0.3335, position: 0.2040, pitch: 0.5782, duration: 0.3957, instrument: 0.4318timesignaturenumerator: 0.0436timesignaturedenominator: 0.0132tempo: 0.0227velocity: 0.1447
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_13000.pt
Training...
Validating...
Validation loss: 13.6321
Individual losses: type=0.0037, beat: 0.3752, position: 0.2134, pitch: 0.5838, duration: 0.3945, instrument: 0.4368timesignaturenumerator: 0.0541timesignaturedenominator: 0.0142tempo: 0.0409velocity: 0.1555
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_14000.pt
Training...
Validating...
Validation loss: 13.0979
Individual losses: type=0.0019, beat: 0.3423, position: 0.2089, pitch: 0.5798, duration: 0.3894, instrument: 0.4317timesignaturenumerator: 0.0448timesignaturedenominator: 0.0099tempo: 0.0295velocity: 0.1448
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_15000.pt
Training...
Validating...
Validation loss: 12.7744
Individual losses: type=0.0017, beat: 0.3104, position: 0.2090, pitch: 0.5769, duration: 0.3867, instrument: 0.4244timesignaturenumerator: 0.0444timesignaturedenominator: 0.0086tempo: 0.0227velocity: 0.1443
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_16000.pt
Training...
Validating...
Validation loss: 12.3870
Individual losses: type=0.0018, beat: 0.2708, position: 0.2077, pitch: 0.5763, duration: 0.3836, instrument: 0.4232timesignaturenumerator: 0.0364timesignaturedenominator: 0.0084tempo: 0.0177velocity: 0.1386
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_17000.pt
Training...
Validating...
Validation loss: 13.3402
Individual losses: type=0.0014, beat: 0.3682, position: 0.2113, pitch: 0.5811, duration: 0.3949, instrument: 0.4295timesignaturenumerator: 0.0454timesignaturedenominator: 0.0146tempo: 0.0305velocity: 0.1465
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_18000.pt
Training...
Validating...
Validation loss: 13.0350
Individual losses: type=0.0014, beat: 0.3341, position: 0.2076, pitch: 0.5892, duration: 0.3936, instrument: 0.4207timesignaturenumerator: 0.0425timesignaturedenominator: 0.0113tempo: 0.0231velocity: 0.1490
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_19000.pt
Training...
Validating...
Validation loss: 12.6800
Individual losses: type=0.0014, beat: 0.2911, position: 0.2113, pitch: 0.5889, duration: 0.3862, instrument: 0.4319timesignaturenumerator: 0.0344timesignaturedenominator: 0.0102tempo: 0.0145velocity: 0.1435
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_20000.pt
Training...
Validating...
Validation loss: 12.2022
Individual losses: type=0.0014, beat: 0.2506, position: 0.2032, pitch: 0.5740, duration: 0.3849, instrument: 0.4230timesignaturenumerator: 0.0329timesignaturedenominator: 0.0099tempo: 0.0119velocity: 0.1419
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_21000.pt
Training...
Validating...
Validation loss: 11.7258
Individual losses: type=0.0014, beat: 0.1800, position: 0.2005, pitch: 0.5809, duration: 0.3768, instrument: 0.4105timesignaturenumerator: 0.0394timesignaturedenominator: 0.0134tempo: 0.0112velocity: 0.1402
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_22000.pt
Training...
Validating...
Validation loss: 11.5808
Individual losses: type=0.0013, beat: 0.1706, position: 0.2030, pitch: 0.5716, duration: 0.3777, instrument: 0.4114timesignaturenumerator: 0.0339timesignaturedenominator: 0.0128tempo: 0.0066velocity: 0.1412
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_23000.pt
Training...
Validating...
Validation loss: 11.4949
Individual losses: type=0.0013, beat: 0.1703, position: 0.1967, pitch: 0.5717, duration: 0.3733, instrument: 0.4104timesignaturenumerator: 0.0374timesignaturedenominator: 0.0113tempo: 0.0084velocity: 0.1350
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/model_24000.pt
Stopped the training for no improvements in 20 rounds.
Minimum validation loss achieved: 10.239285695125382
Saved the optimizer state to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/optimizer_24000.pt
Saved the scheduler state to: /hpctmp/e0787977/mmt/exp/lmd_full_text/transformer/checkpoints/scheduler_24000.pt
