Running command: python mmt+/train.py -m mamba -d lmd_full_text -o exp/lmd_full_text/mamba -g 1
Using arguments:
{'abs_pos_emb': True,
 'aug': True,
 'batch_size': 8,
 'comment_path': 'md5_to_attribute.pickle',
 'dataset': 'lmd_full_text',
 'dim': 512,
 'dropout': 0.2,
 'early_stopping': True,
 'early_stopping_tolerance': 20,
 'gpu': 1,
 'grad_norm_clip': 1.0,
 'heads': 8,
 'in_dir': PosixPath('data/lmd_full_text/processed/notes'),
 'jobs': 4,
 'layers': 6,
 'learning_rate': 0.0005,
 'lr_decay_multiplier': 0.1,
 'lr_decay_steps': 100000,
 'lr_warmup_steps': 5000,
 'max_beat': 256,
 'max_seq_len': 1024,
 'model': 'mamba',
 'out_dir': PosixPath('/hpctmp/e0787977/mmt/exp/lmd_full_text/mamba'),
 'quiet': False,
 'rel_pos_emb': False,
 'steps': 200000,
 'tokenizer_path': 'tokenizer.model',
 'train_names': PosixPath('data/lmd_full_text/processed/train-names.txt'),
 'update_policy': 'task',
 'use_csv': False,
 'valid_names': PosixPath('data/lmd_full_text/processed/valid-names.txt'),
 'valid_steps': 1000}
Saved arguments to /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/train-args.json
Using device: cuda:1
Creating the data loader...
Creating model...
Number of parameters: 44346938
Number of trainable parameters: 44346938
Training...
Validating...
Validation loss: 10.7088
Individual losses: type=0.0011, beat: 0.1232, position: 0.1900, pitch: 0.5516, duration: 0.3507, instrument: 0.3807timesignaturenumerator: 0.0329timesignaturedenominator: 0.0125tempo: 0.0060velocity: 0.1196
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_1000.pt
Training...
Validating...
Validation loss: 9.7882
Individual losses: type=0.0013, beat: 0.0911, position: 0.1792, pitch: 0.5132, duration: 0.3392, instrument: 0.3653timesignaturenumerator: 0.0162timesignaturedenominator: 0.0057tempo: 0.0038velocity: 0.1164
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_2000.pt
Training...
Validating...
Validation loss: 9.3113
Individual losses: type=0.0011, beat: 0.0807, position: 0.1728, pitch: 0.4937, duration: 0.3306, instrument: 0.3443timesignaturenumerator: 0.0117timesignaturedenominator: 0.0041tempo: 0.0031velocity: 0.1098
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_3000.pt
Training...
Validating...
Validation loss: 9.0880
Individual losses: type=0.0012, beat: 0.0773, position: 0.1697, pitch: 0.4856, duration: 0.3262, instrument: 0.3329timesignaturenumerator: 0.0090timesignaturedenominator: 0.0037tempo: 0.0026velocity: 0.1066
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_4000.pt
Training...
Validating...
Validation loss: 17.4090
Individual losses: type=0.0014, beat: 0.7894, position: 0.2608, pitch: 0.6057, duration: 0.4278, instrument: 0.4596timesignaturenumerator: 0.0939timesignaturedenominator: 0.0325tempo: 0.0674velocity: 0.1630
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_5000.pt
Training...
Validating...
Validation loss: 16.9279
Individual losses: type=0.0016, beat: 0.7571, position: 0.2563, pitch: 0.6065, duration: 0.4240, instrument: 0.4620timesignaturenumerator: 0.0819timesignaturedenominator: 0.0259tempo: 0.0466velocity: 0.1595
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_6000.pt
Training...
Validating...
Validation loss: 16.7131
Individual losses: type=0.0018, beat: 0.7258, position: 0.2560, pitch: 0.6114, duration: 0.4236, instrument: 0.4555timesignaturenumerator: 0.0858timesignaturedenominator: 0.0252tempo: 0.0369velocity: 0.1635
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_7000.pt
Training...
Validating...
Validation loss: 16.4607
Individual losses: type=0.0018, beat: 0.7042, position: 0.2548, pitch: 0.6044, duration: 0.4216, instrument: 0.4537timesignaturenumerator: 0.0804timesignaturedenominator: 0.0259tempo: 0.0391velocity: 0.1577
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_8000.pt
Training...
Validating...
Validation loss: 17.4836
Individual losses: type=0.0015, beat: 0.7843, position: 0.2572, pitch: 0.6087, duration: 0.4249, instrument: 0.4609timesignaturenumerator: 0.0850timesignaturedenominator: 0.0280tempo: 0.0976velocity: 0.1658
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_9000.pt
Training...
Validating...
Validation loss: 17.1343
Individual losses: type=0.0018, beat: 0.7752, position: 0.2560, pitch: 0.6124, duration: 0.4227, instrument: 0.4538timesignaturenumerator: 0.0864timesignaturedenominator: 0.0262tempo: 0.0564velocity: 0.1647
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_10000.pt
Training...
Validating...
Validation loss: 16.9449
Individual losses: type=0.0013, beat: 0.7613, position: 0.2558, pitch: 0.6187, duration: 0.4218, instrument: 0.4561timesignaturenumerator: 0.0819timesignaturedenominator: 0.0270tempo: 0.0359velocity: 0.1641
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_11000.pt
Training...
Validating...
Validation loss: 16.8845
Individual losses: type=0.0017, beat: 0.7568, position: 0.2560, pitch: 0.6092, duration: 0.4223, instrument: 0.4567timesignaturenumerator: 0.0802timesignaturedenominator: 0.0271tempo: 0.0417velocity: 0.1625
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_12000.pt
Training...
Validating...
Validation loss: 16.5447
Individual losses: type=0.0014, beat: 0.7268, position: 0.2541, pitch: 0.6019, duration: 0.4206, instrument: 0.4550timesignaturenumerator: 0.0806timesignaturedenominator: 0.0248tempo: 0.0338velocity: 0.1584
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_13000.pt
Training...
Validating...
Validation loss: 16.6247
Individual losses: type=0.0013, beat: 0.7221, position: 0.2538, pitch: 0.6092, duration: 0.4180, instrument: 0.4523timesignaturenumerator: 0.0784timesignaturedenominator: 0.0264tempo: 0.0519velocity: 0.1574
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_14000.pt
Training...
Validating...
Validation loss: 16.5609
Individual losses: type=0.0013, beat: 0.7220, position: 0.2525, pitch: 0.6088, duration: 0.4176, instrument: 0.4535timesignaturenumerator: 0.0857timesignaturedenominator: 0.0273tempo: 0.0301velocity: 0.1614
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_15000.pt
Training...
Validating...
Validation loss: 16.6119
Individual losses: type=0.0017, beat: 0.7270, position: 0.2530, pitch: 0.6050, duration: 0.4184, instrument: 0.4532timesignaturenumerator: 0.0809timesignaturedenominator: 0.0248tempo: 0.0469velocity: 0.1579
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_16000.pt
Training...
Validating...
Validation loss: 16.5311
Individual losses: type=0.0015, beat: 0.7271, position: 0.2535, pitch: 0.6046, duration: 0.4168, instrument: 0.4478timesignaturenumerator: 0.0803timesignaturedenominator: 0.0248tempo: 0.0422velocity: 0.1565
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_17000.pt
Training...
Validating...
Validation loss: 16.6145
Individual losses: type=0.0015, beat: 0.7352, position: 0.2515, pitch: 0.6042, duration: 0.4194, instrument: 0.4492timesignaturenumerator: 0.0798timesignaturedenominator: 0.0245tempo: 0.0439velocity: 0.1599
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_18000.pt
Training...
Validating...
Validation loss: 23.5346
Individual losses: type=0.0192, beat: 0.9155, position: 0.2952, pitch: 0.6320, duration: 0.4524, instrument: 0.6879timesignaturenumerator: 0.1203timesignaturedenominator: 0.0434tempo: 0.5302velocity: 0.2263
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_19000.pt
Training...
Validating...
Validation loss: 17.6467
Individual losses: type=0.0046, beat: 0.7974, position: 0.2583, pitch: 0.6075, duration: 0.4277, instrument: 0.4619timesignaturenumerator: 0.0914timesignaturedenominator: 0.0302tempo: 0.0877velocity: 0.1744
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_20000.pt
Training...
Validating...
Validation loss: 20.1891
Individual losses: type=0.0393, beat: 0.8570, position: 0.3034, pitch: 0.6507, duration: 0.4697, instrument: 0.4994timesignaturenumerator: 0.1194timesignaturedenominator: 0.0649tempo: 0.1526velocity: 0.2086
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_21000.pt
Training...
Validating...
Validation loss: 18.8988
Individual losses: type=0.0222, beat: 0.8199, position: 0.2830, pitch: 0.6331, duration: 0.4516, instrument: 0.4800timesignaturenumerator: 0.1027timesignaturedenominator: 0.0493tempo: 0.1182velocity: 0.1898
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_22000.pt
Training...
Validating...
Validation loss: 18.0424
Individual losses: type=0.0099, beat: 0.8029, position: 0.2687, pitch: 0.6188, duration: 0.4374, instrument: 0.4663timesignaturenumerator: 0.0906timesignaturedenominator: 0.0351tempo: 0.1005velocity: 0.1769
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_23000.pt
Training...
Validating...
Validation loss: 17.5510
Individual losses: type=0.0043, beat: 0.7895, position: 0.2606, pitch: 0.6193, duration: 0.4289, instrument: 0.4595timesignaturenumerator: 0.0785timesignaturedenominator: 0.0264tempo: 0.0906velocity: 0.1675
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_24000.pt
Training...
Validating...
Validation loss: 17.3792
Individual losses: type=0.0038, beat: 0.7872, position: 0.2578, pitch: 0.6099, duration: 0.4255, instrument: 0.4568timesignaturenumerator: 0.0797timesignaturedenominator: 0.0258tempo: 0.0834velocity: 0.1667
Saved the model to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/model_25000.pt
Stopped the training for no improvements in 20 rounds.
Minimum validation loss achieved: 9.088001237922455
Saved the optimizer state to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/optimizer_25000.pt
Saved the scheduler state to: /hpctmp/e0787977/mmt/exp/lmd_full_text/mamba/checkpoints/scheduler_25000.pt
