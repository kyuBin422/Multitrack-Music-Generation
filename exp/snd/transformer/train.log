Running command: python mmt+/train.py -m transformer -d snd -o exp/snd/transformer -g 1
Using arguments:
{'abs_pos_emb': True,
 'aug': True,
 'batch_size': 8,
 'comment_path': 'md5_to_attribute.pickle',
 'dataset': 'snd',
 'dim': 512,
 'dropout': 0.2,
 'early_stopping': True,
 'early_stopping_tolerance': 20,
 'gpu': 1,
 'grad_norm_clip': 1.0,
 'heads': 8,
 'in_dir': PosixPath('data/snd/processed/notes'),
 'jobs': 4,
 'layers': 6,
 'learning_rate': 0.0005,
 'lr_decay_multiplier': 0.1,
 'lr_decay_steps': 100000,
 'lr_warmup_steps': 5000,
 'max_beat': 256,
 'max_seq_len': 1024,
 'model': 'transformer',
 'out_dir': PosixPath('/hpctmp/e0787977/mmt/exp/snd/transformer'),
 'quiet': False,
 'rel_pos_emb': False,
 'steps': 200000,
 'tokenizer_path': 'tokenizer.model',
 'train_names': PosixPath('data/snd/processed/train-names.txt'),
 'update_policy': 'task',
 'use_csv': False,
 'valid_names': PosixPath('data/snd/processed/valid-names.txt'),
 'valid_steps': 1000}
Saved arguments to /hpctmp/e0787977/mmt/exp/snd/transformer/train-args.json
Using device: cuda:1
Creating the data loader...
Creating model...
Number of parameters: 20013625
Number of trainable parameters: 20013625
Training...
Validating...
Validation loss: 15.6580
Individual losses: type=0.0012, beat: 0.6868, position: 0.1744, pitch: 0.6559, duration: 0.3202, instrument: 0.5144timesignaturenumerator: 0.0902timesignaturedenominator: 0.0270tempo: 0.0207velocity: 0.1188
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_1000.pt
Training...
Validating...
Validation loss: 16.2102
Individual losses: type=0.0013, beat: 0.7393, position: 0.1690, pitch: 0.6680, duration: 0.3114, instrument: 0.5229timesignaturenumerator: 0.0823timesignaturedenominator: 0.0209tempo: 0.0364velocity: 0.1502
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_2000.pt
Training...
Validating...
Validation loss: 15.8580
Individual losses: type=0.0018, beat: 0.7036, position: 0.1686, pitch: 0.6535, duration: 0.3094, instrument: 0.5245timesignaturenumerator: 0.0871timesignaturedenominator: 0.0182tempo: 0.0375velocity: 0.1387
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_3000.pt
Training...
Validating...
Validation loss: 14.3391
Individual losses: type=0.0012, beat: 0.6073, position: 0.1552, pitch: 0.6440, duration: 0.2853, instrument: 0.5029timesignaturenumerator: 0.0589timesignaturedenominator: 0.0082tempo: 0.0103velocity: 0.1165
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_4000.pt
Training...
Validating...
Validation loss: 15.5421
Individual losses: type=0.0012, beat: 0.6348, position: 0.1564, pitch: 0.6368, duration: 0.2951, instrument: 0.5084timesignaturenumerator: 0.0734timesignaturedenominator: 0.0206tempo: 0.1405velocity: 0.1231
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_5000.pt
Training...
Validating...
Validation loss: 14.5094
Individual losses: type=0.0012, beat: 0.6311, position: 0.1574, pitch: 0.6281, duration: 0.2850, instrument: 0.5116timesignaturenumerator: 0.0564timesignaturedenominator: 0.0188tempo: 0.0110velocity: 0.1176
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_6000.pt
Training...
Validating...
Validation loss: 24.1463
Individual losses: type=0.0017, beat: 0.8524, position: 0.2796, pitch: 0.7101, duration: 0.4231, instrument: 0.8598timesignaturenumerator: 0.1783timesignaturedenominator: 0.0524tempo: 0.1448velocity: 0.5221
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_7000.pt
Training...
Validating...
Validation loss: 14.6119
Individual losses: type=0.0012, beat: 0.6777, position: 0.1575, pitch: 0.6227, duration: 0.2983, instrument: 0.4966timesignaturenumerator: 0.0447timesignaturedenominator: 0.0079tempo: 0.0228velocity: 0.1059
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_8000.pt
Training...
Validating...
Validation loss: 14.0354
Individual losses: type=0.0012, beat: 0.6445, position: 0.1470, pitch: 0.6278, duration: 0.2826, instrument: 0.4819timesignaturenumerator: 0.0384timesignaturedenominator: 0.0055tempo: 0.0070velocity: 0.1034
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_9000.pt
Training...
Validating...
Validation loss: 13.9729
Individual losses: type=0.0012, beat: 0.6400, position: 0.1519, pitch: 0.6248, duration: 0.2772, instrument: 0.4881timesignaturenumerator: 0.0363timesignaturedenominator: 0.0058tempo: 0.0058velocity: 0.0975
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_10000.pt
Training...
Validating...
Validation loss: 14.6935
Individual losses: type=0.0012, beat: 0.6615, position: 0.2214, pitch: 0.6417, duration: 0.2991, instrument: 0.4769timesignaturenumerator: 0.0347timesignaturedenominator: 0.0069tempo: 0.0057velocity: 0.0998
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_11000.pt
Training...
Validating...
Validation loss: 14.4715
Individual losses: type=0.0014, beat: 0.6951, position: 0.1531, pitch: 0.6333, duration: 0.2772, instrument: 0.4844timesignaturenumerator: 0.0449timesignaturedenominator: 0.0057tempo: 0.0044velocity: 0.1125
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_12000.pt
Training...
Validating...
Validation loss: 14.1756
Individual losses: type=0.0013, beat: 0.6656, position: 0.1560, pitch: 0.6180, duration: 0.2806, instrument: 0.4762timesignaturenumerator: 0.0331timesignaturedenominator: 0.0058tempo: 0.0053velocity: 0.1206
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_13000.pt
Training...
Validating...
Validation loss: 13.8831
Individual losses: type=0.0012, beat: 0.6414, position: 0.1505, pitch: 0.6316, duration: 0.2738, instrument: 0.4702timesignaturenumerator: 0.0371timesignaturedenominator: 0.0060tempo: 0.0040velocity: 0.0979
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_14000.pt
Training...
Validating...
Validation loss: 14.1541
Individual losses: type=0.0015, beat: 0.6505, position: 0.1573, pitch: 0.6231, duration: 0.2771, instrument: 0.4879timesignaturenumerator: 0.0446timesignaturedenominator: 0.0066tempo: 0.0092velocity: 0.1013
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_15000.pt
Training...
Validating...
Validation loss: 14.1015
Individual losses: type=0.0013, beat: 0.6552, position: 0.1510, pitch: 0.6296, duration: 0.2814, instrument: 0.4711timesignaturenumerator: 0.0406timesignaturedenominator: 0.0065tempo: 0.0136velocity: 0.1001
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_16000.pt
Training...
Validating...
Validation loss: 14.1756
Individual losses: type=0.0013, beat: 0.6782, position: 0.1662, pitch: 0.6174, duration: 0.2844, instrument: 0.4721timesignaturenumerator: 0.0291timesignaturedenominator: 0.0050tempo: 0.0117velocity: 0.0972
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_17000.pt
Training...
Validating...
Validation loss: 14.0354
Individual losses: type=0.0012, beat: 0.6694, position: 0.1510, pitch: 0.6170, duration: 0.2758, instrument: 0.4764timesignaturenumerator: 0.0314timesignaturedenominator: 0.0055tempo: 0.0096velocity: 0.1018
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_18000.pt
Training...
Validating...
Validation loss: 14.1911
Individual losses: type=0.0012, beat: 0.6344, position: 0.1541, pitch: 0.6284, duration: 0.3081, instrument: 0.4807timesignaturenumerator: 0.0439timesignaturedenominator: 0.0049tempo: 0.0045velocity: 0.1047
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_19000.pt
Training...
Validating...
Validation loss: 13.7219
Individual losses: type=0.0013, beat: 0.6482, position: 0.1472, pitch: 0.6179, duration: 0.2702, instrument: 0.4678timesignaturenumerator: 0.0301timesignaturedenominator: 0.0057tempo: 0.0040velocity: 0.0946
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_20000.pt
Training...
Validating...
Validation loss: 14.0715
Individual losses: type=0.0013, beat: 0.6489, position: 0.1459, pitch: 0.6133, duration: 0.2741, instrument: 0.4680timesignaturenumerator: 0.0284timesignaturedenominator: 0.0051tempo: 0.0036velocity: 0.1568
Saved the model to: /hpctmp/e0787977/mmt/exp/snd/transformer/checkpoints/model_21000.pt
Training...
